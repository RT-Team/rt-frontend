<<<<<<< HEADBASE_URL=location.protocol+"//"+location.hostname;var parameters={},parameter_url=location.search.substring(1).split("&");for(par of parameter_url)parameters[par.split("=")[0]]=par.split("=")[1];function return_commands(data){var command_list=[];for(command_name in data){var command=data[command_name];for(item_name in command.items){var item=command.items[item_name];switch(item.item_type){case"text":item.text.multiple_line?command_list.push(`\n                            <b>${command_name}</b>\n                            <div>${command.description}</div>\n                            <label>\n                                <div>${item.display_name}</div>\n                                <input type="text" value="${item.text.text}" name="${command_name}.${item_name}">\n                            </label>\n                        `):command_list.push(`\n                            <b>${command_name}</b>\n                            <div>${command.description}</div>\n                            <label>\n                                <div>${item.display_name}</div>\n                                <textarea type="text" name="${command_name}.${item_name}" rows="3">${item.text.text}</textarea>\n                            </label>\n                        `);break;case"check":command_list.push(`\n                        <b>${command_name}</b>\n                        <div>${command.description}</div>\n                        <label>\n                            <div>${item.display_name}</div>\n                            <input type="checkbox" name="${command_name}.${item_name}" value="true" ${item.check.checked?"checked":""}>\n                        </label>\n                    `);break;case"radios":var radio_list=[];for(radio in item.radios)radio_list.push(`\n                            <input type="radio" name="${command_name}.${item_name}" value="${radio}" ${item.radios[radio]?"checked":""}>\n                            ${radio}\n                        `);command_list.push(`\n                        <b>${command_name}</b>\n                        <div>${command.description}</div>\n                        <label>\n                            <div>${item.display_name}</div>\n                            <span>${radio_list.join("")}</span>\n                        </label>\n                    `);break;case"list":var i=0,option_list=[];for(option in item.list.texts)option_list.push(`\n                            <option value="${option}" ${item.list.index==i?"checked":""}>${item.list.texts[option]}</option>\n                        `),i++;command_list.push(`\n                        <b>${command_name}</b>\n                        <div>${command.description}</div>\n                        <label>\n                            <div>${item.display_name}</div>\n                            <select name="${command_name}.${item_name}">\n                                ${option_list.push("")}\n                            </select>\n                        </label>\n                    `)}}}return command_list}$((function(){if($.ajax({url:`${BASE_URL}/account/`,type:"get",dataType:"json"}).done((function(data){data.login?("login"==parameters.p&&(location.href="/dashboard.html"),$("header div img").attr("src",data.icon_url),$("header div div").text(data.user_name)):"login"!=parameters.p&&(location.href="?p=login")})),"p"in parameters)switch(parameters.p){case"server":$('.sidebar .menu .item[data-p="server"]').addClass("select"),$.ajax({url:`${BASE_URL}/api/settings/guild`,type:"get",dataType:"json"}).done((function(data){if("id"in parameters)parameters.id in data.settings?$(".main").html(`\n                                <div class="page-server">\n                                    <h1>サーバー > ${data.settings[parameters.id].name} > 設定</h1>\n                                    <form action="${BASE_URL}/api/settings/update/guild/${parameters.id}" method="POST">\n                                        <div class="setting">\n                                            ${return_commands(data.settings[parameters.id].commands).join("")}\n                                            <b class="update">\n                                                設定を変更したら保存してください:\n                                                <div>\n                                                    <button type="reset">リセット</button>\n                                                    <button type="submit">保存</button>\n                                                </div>\n                                            </b>\n                                        </div>\n                                    </form>\n                                </div>\n                            `):location.href="/dashboard.html?p=server";else{var server_list=[];for(server in data.settings)server_list.push(`\n                                <a href="/dashboard.html?p=server&id=${server}" class="item">\n                                    <img src="${data.settings[server].icon?data.settings[server].icon:"img/discord.png"}">\n                                    <div>${data.settings[server].name}</div>\n                                </a>\n                            `);$(".main").html(`\n                            <div class="page-server">\n                                <h1>サーバー > サーバー選択</h1>\n                                <div class="server-list">${server_list.join("")}</div>\n                            </div>\n                        `)}}));break;case"user":$('.sidebar .menu .item[data-p="user"]').addClass("select"),$.ajax({url:`${BASE_URL}/api/settings/user`,type:"get",dataType:"json"}).done((function(data){$(".main").html(`\n                        <div class="page-user">\n                            <h1>ユーザー > 設定</h1>\n                            <form action="${BASE_URL}/api/settings/update/user" method="POST">\n                                <div class="setting">\n                                    ${return_commands(data.settings).join("")}\n                                    <b class="update">\n                                        設定を変更したら保存してください:\n                                        <div>\n                                            <button type="reset">リセット</button>\n                                            <button type="submit">保存</button>\n                                        </div>\n                                    </b>\n                                </div>\n                            </form>\n                        </div>\n                    `)}));break;case"logout":$('.sidebar .menu .item[data-p="logout"]').addClass("select"),$(".main").html(`\n                    <h1>Discordからログアウト</h1>\n                    <div>Discordからログアウトしますか？<br>再度ダッシュボードを使うにはログインする必要があります。</div>\n                    <a href="${BASE_URL}/account/logout/" class="btn">ログアウト</a>\n                    <a href="/dashboard.html" class="btn btn-dark">戻る</a>\n                `);break;case"login":$(".main").html(`\n                    <h1>Discordでログイン</h1>\n                    <div>Discordを使ってログインしますか？<br>ログインをするとRTの設定などがWebで行えるようになります。</div>\n                    <a href="${BASE_URL}/account/login/" class="btn">ログイン</a>\n                    <a href="/" class="btn btn-dark">戻る</a>\n                `);break;default:location.href="/dashboard.html"}else $('.sidebar .menu .item[data-p="home"]').addClass("select"),$.ajax({url:`${BASE_URL}/account/`,type:"get",dataType:"json"}).done((function(data){$(".main").html(`\n                <div class="page-main">\n                    <img src="${data.icon_url}">\n                    <div class="hello">\n                        <h1>Hello, ${data.user_name}!</h1>\n                        <div class="logo">\n                            <img src="img/icon.png">\n                            <div>\n                                RT Dashboard\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            `)}))}));